<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>An Introduction To Ruby Code blocks Part 1 | Thumbs Up Rails</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="An Introduction To Ruby Code blocks Part 1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My First Ruby Problem" />
<meta property="og:description" content="My First Ruby Problem" />
<link rel="canonical" href="http://localhost:4000/ruby/2025/04/16/an-introduction-to-ruby-code-blocks-part-1.html" />
<meta property="og:url" content="http://localhost:4000/ruby/2025/04/16/an-introduction-to-ruby-code-blocks-part-1.html" />
<meta property="og:site_name" content="Thumbs Up Rails" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-04-16T10:30:20+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="An Introduction To Ruby Code blocks Part 1" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-16T10:30:20+03:00","datePublished":"2025-04-16T10:30:20+03:00","description":"My First Ruby Problem","headline":"An Introduction To Ruby Code blocks Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/ruby/2025/04/16/an-introduction-to-ruby-code-blocks-part-1.html"},"url":"http://localhost:4000/ruby/2025/04/16/an-introduction-to-ruby-code-blocks-part-1.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Thumbs Up Rails" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Thumbs Up Rails</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/assets/documents/resume.pdf" target="_blank" rel="noopener noreferrer">Resume</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">An Introduction To Ruby Code blocks Part 1</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-04-16T10:30:20+03:00" itemprop="datePublished">Apr 16, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="my-first-ruby-problem">My First Ruby Problem</h2>

<p>When i had started out to learn ruby, one of the earliest problems i was presented with was related to arrays. In this problem, you have an array. Then you have to iterate over that array such that you have each element of the array printed on its own line in the interpreter. For visual purposes, here is the problem plus its solution below implemented in irb.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">numbers</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">number</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">number</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The output:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1
2
3
 <span class="o">=&gt;</span> <span class="o">[</span>1, 2, 3]
</code></pre></div></div>
<p>The solution is pretty simple, you utilize the “each” method for the iteration. This method is available for all arrays as part of the Array class. In addition to this, the solution utilizes a do-end block which specifies what should be done for each element in the array. In our case, we just print each element on its line in the irb console, but there are endless possibilities regarding what you could do with an element you’ve iterated over.</p>

<h2 id="enter-code-blocks">Enter Code Blocks</h2>

<p>Unbeknownst to me back then, that do-end block has a specific term ruby programmers used to refer to it and it can do way more, than just printing out array elements to the console.</p>

<p>The name of that do-end block is a code block, and to be specific about the kind of code block, since code blocks come in 2 variants, the code block in the array example above is an implicit code block. We’ll go over why it’s called an Implicit code block later on. But first, a short introduction to Ruby code blocks.</p>

<p>Put simply a code block is an executable piece of code that tends to be associated with a given method. This method is responsible for executing the code block passed to it.</p>

<h3 id="your-first-ruby-code-block">Your First Ruby Code Block</h3>

<p>Let’s say you have a method below:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">my_method</span>
  <span class="k">yield</span> <span class="k">if</span> <span class="nb">block_given?</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Then at any other place in your program, you have the code below:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">my_method</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="s2">"This is the output   derived from executing the code block"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The above can also be written as:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">my_method</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">"This is the output derived from executing the code block"</span><span class="p">}</span>
</code></pre></div></div>

<p>When we run either of the examples above in the ruby interpreter, we’ll have the statement below as the output:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"This is the output derived from executing the code block"</span>
</code></pre></div></div>

<h3 id="behind-the-scenes">Behind the scenes</h3>

<p>So how did we arrive at this output:</p>

<p>First and foremost, let’s examine the method. We defined a method named “my_method”. Inside the method, we have a yield keyword bound to an if statement.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">yield</span> <span class="k">if</span> <span class="nb">block_given?</span>
</code></pre></div></div>
<p>Inside the method, we perform a conditional check. We evaluate whether a code block was passed to the “my_method” method using the block_given? method which evaluates to true or false. If the conditional check evaluates to true i.e a code block was passed when calling the method, we proceed to return the output of executing the code inside the code block. To return this output for the user to see in the interpreter, we use the yield keyword.</p>

<p>All in all 2 things are crucial within this method for the desired functionality to be achieved:</p>
<ul>
  <li>The block_given? Method which evaluates to a Boolean and performs a conditional check.</li>
  <li>yield which returns the output of executing the code inside the code block</li>
</ul>

<p>We can also write the same method as:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">my_method</span>
  <span class="k">if</span> <span class="nb">block_given?</span>
    <span class="k">yield</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Now onto the code block itself.
This is responsible for the output we see in the interpreter. 
So in the code above , what we are doing is, we call a method and pass a code-block to it. And since the method does a conditional check with the block_given? method to see if a code block was passed to the method when it was called, the “my_method” method knows exactly how to handle this situation.</p>

<p>In the example above, so many moving parts are responsible for the output we end up seeing in the irb session. 
Now a hypothetical, what would be the output of running this program if we don’t perform the conditional check?</p>

<p>In case we defined the same method without the conditional check like below, then proceed to pass a code block to that method, we observe that no output is returned in the irb session.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">my_method</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">my_method</span> <span class="k">do</span>
  <span class="nb">puts</span> <span class="s2">"This is the output derived from executing the code block"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Trying to run the above will result in “nil” as the output. This is because, as much as our syntax for passing a code block to my_method is correct, the method itself doesn’t know what to do with the code block, which is why we don’t get the expected output.
The “nil” output wasn’t returned by the my_method, its pretty standard output.
So to be more specific about what happened, when you pass a code block to a method that isn’t in the know about what it should do with the code block and proceed to call that method, nothing is executed and nothing is returned.</p>

<h3 id="why-the-name-implicit-code-block">Why the name “Implicit code block”?</h3>

<p>Take the example method below:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">say_name</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"Your name is </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</code></pre></div></div>

<p>To have this method return a name of the current user, we simply call the method and pass in an argument of whatever name we want to return.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">say_name</span><span class="p">(</span><span class="s2">"Newton"</span><span class="p">)</span>
</code></pre></div></div>
<p>Output:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Your</span> <span class="nb">name</span> <span class="n">is</span> <span class="no">Newton</span>
</code></pre></div></div>

<p>Contrast the method above with the “my_method” method.</p>

<p>The method “my_method” differs from the “say_name” method in 1 major way:
When defining the “my_method” method, we didn’t specify any parameters for it. Because of this, when the method is called(along with the code block passed to it), the code block is not passed as an argument to the method. Since we call the method and pass a code block which isn’t treated by the method as an argument, this code block is referred to as an implicit code block.</p>

<p>This poses a few implications:
Because the code block is passed to the method not as an argument, what we can achieve with this code block is limited.</p>

<p>Think about it, if we were able to pass the code block as an argument when calling the method, we would be able to associate this code block with a parameter which means we can store whatever is in the code block and therefore use it later instead of instantly. This specific kind of code block is an Explicit code block which we’ll look at in part 2 of this section.</p>

<h2 id="a-closer-look-at-rubys-each-method">A Closer look at Ruby’s “each” method.</h2>

<p>Like we mentioned earlier, the solution for the array problem used the “each” ruby method whose underlying operating principle is similar to that of Implicit code blocks in Ruby. We can confirm this by taking a look at the source of Ruby’s “each” method.</p>
<pre><code class="language-C">VALUE
rb_ary_each(VALUE ary)
{
  long i;
  ary_verify(ary);
  RETURN_SIZED_ENUMERATOR(ary, 0, 0, ary_enum_length);
  for (i=0; i&lt;RARRAY_LEN(ary); i++) {
    rb_yield(RARRAY_AREF(ary, i));
  }
  return ary;
}
</code></pre>
<p>In this code, a couple things are happening but a few stand out.</p>

<ol>
  <li>The “each” method utilizes an equivalent of “yield” named “<strong>rb_yield</strong>”.</li>
  <li><strong>RETURN_SIZED_ENUMERATOR</strong>  checks for the presence of a block similar like what the block_given? method employed by the method “my_method” does. 
See the code attached below:</li>
</ol>

<pre><code class="language-C">#define RETURN_SIZED_ENUMERATOR(obj, argc, argv, size_fn) do { \
  if (!rb_block_given_p()) \
    return SIZED_ENUMERATOR(obj, argc, argv, size_fn); 
} while (0)
</code></pre>

<p>In the above code, we have a function named <strong>rb_block_given_p()</strong> whose purpose is to check whether the current method, in this case the “each” method is given a block. The rb_block_given_p() function as well as the block_given? ruby method, are of a similar importance, that is to check whether a given method was passed a block.</p>

<p>Based on the above findings, we can confidently say that the “each” ruby method operates based on the principle of implicit code blocks under the hood.</p>

<h2 id="conclusion">Conclusion</h2>
<p>In case you’re interested, you read more about RETURN_SIZED_ENUMERATOR, ruby’s each method as well as the rb_block_given_p() by visiting the resources below:</p>
<ol>
  <li><a href="https://ruby-doc.org/3.4.1/Array.html#method-i-each">Each Ruby method</a></li>
  <li><a href="https://docs.ruby-lang.org/capi/en/master/dc/d1b/include_2ruby_2internal_2intern_2enumerator_8h_source.html">RETURN_SIZED_ENUMERATOR macros</a></li>
  <li><a href="https://docs.ruby-lang.org/capi/en/master/d7/d19/group__defmethod.html">rb_block_given_p function</a></li>
</ol>

<p>This part served as an introduction to implicit code blocks, and looked at the use cases for implicit code blocks which is iterating over elements in an array. In part 2, we’ll look at yet another type of Ruby code blocks named Explicit code blocks and highlight how this specific kind of code block solves the short comings of Implicit code blocks.</p>

  </div><a class="u-url" href="/ruby/2025/04/16/an-introduction-to-ruby-code-blocks-part-1.html" hidden></a>
</article>

      </div>
    </main></body>

</html>
